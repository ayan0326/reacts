<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div class="item" id="arr1">
        <video id="video"  height="100%" width="100%" muted loop autoplay>
            <source src="./_Cyberpunk24.mp4"
            type="video/mp4" />
        </video>
    </div>
    <div class="item" id="arr2">
        <video id="video-2" controls="controls" height="100%" width="100%">
            <source src="https://img.qiuchengwangluo.com/union/2019/08/3/20190917124846354378861.mp4"
                type="video/mp4" />
        </video>
    </div>
    <div class="item" id="arr3">
        <video id="video-3" controls="controls" height="100%" width="100%">
            <source src="https://img.qiuchengwangluo.com/union/2019/08/3/20190917124846354378861.mp4"
                type="video/mp4" />
        </video>
    </div>
    <div class="item" id="arr4">
        <video id="video-4" controls="controls" height="100%" width="100%">
            <source src="https://img.qiuchengwangluo.com/union/2019/08/3/20190917124846354378861.mp4"
                type="video/mp4" />
        </video>
    </div>



    <!-- <script>
        let a = 1 // 设置一个初始值，
        let DOMobj = '' // 用了保存getElementById获取到的元素数据
        let clientData = this.getViewport() // 获取可视区的大小

        function getViewport() {
            if (document.compatMode == "BackCompat") {
                return {
                    width: document.body.clientWidth,
                    height: document.body.clientHeight
                }
            } else {
                return {
                    width: document.documentElement.clientWidth,
                    height: document.documentElement.clientHeight
                }
            }
        }

        function getDMOlocation() { // 获取元素的相关数据
            DOMobj = document.getElementById(`arr${a}`)
            cliHeight = (clientData.height - DOMobj.offsetHeight) / 2
        }

        window.onload = this.getDMOlocation()

        function getElementViewTop(element) {
            var actualTop = element.offsetTop;
            var current = element.offsetParent;

            while (current !== null) {
                actualTop += current.offsetTop;
                current = current.offsetParent;
            }

            if (document.compatMode == "BackCompat") {
                var elementScrollTop = document.body.scrollTop;
            } else {
                var elementScrollTop = document.documentElement.scrollTop;
            }

            return actualTop - elementScrollTop;
        }

        window.addEventListener('scroll', winScroll);

        function winScroll(e) {
            let arr = this.getElementViewTop(DOMobj)
            let viedos = document.getElementById(`video-${a}`)
            if (arr <= cliHeight && -arr <= DOMobj.offsetHeight / 2) {
                viedos.play()
            } else {
                viedos.pause()
                if (-arr > DOMobj.offsetHeight / 2) {
                    a += 1
                } else if (-arr < 0) {
                    if (a === 1) {
                        return
                    } else {
                        a -= 1
                    }
                }
                this.getDMOlocation()
            }
        };

        if (-arr > DOMobj.offsetHeight / 2) {
            a += 1
        } else if (-arr < 0) {
            if (a === 1) {
                return
            } else {
                a -= 1
            }
        }
        this.getDMOlocation()
    </script> -->



    <script type="text/javascript">
        var videoList = $('video');
        var wHeigt = window.innerHeight;
        for (var i = 0; i < videoList.length; i++) {
            var v = videoList[i];
            v.height = $(v).height();
            v.top = $(v).offset().top;
        }
        //sTop加50，是考虑页头的高度，遮档了内容的可视区，这点大家灵活处理
        $(document).on('scroll.blogDetail', function () {
            var sTop = $(document).scrollTop();
            var hasPlay = false;
            for (var i = 0; i < videoList.length; i++) {
                var v = videoList[i];
                if (!hasPlay && v.top > (sTop + 50) && (wHeigt + sTop) > (v.top + v.height)) {
                    v.play();
                } else {
                    v.pause();
                }
            }
        });
    </script>

</body>

</html>